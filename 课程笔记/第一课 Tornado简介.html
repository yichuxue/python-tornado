<html>
<head>
  <title>Evernote Export</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/304720 (zh-CN, DDL); Windows/6.1.7601 Service Pack 1 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="405"/>

<div>
<span><div><span style="font-size: 21px;"><b>第一课 Tornado简介</b></span></div><div><b><span style="font-size: 21px;"><br/></span></b></div><div style="font-style: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div><span style="font-size: 14px;"><span style="font-family: Arial, Helvetica, sans-serif;">Tornado是使用Python编写的一个强大的、可扩展的Web服务器。它在处理严峻的网络流量时表现得足够强健，但却在创建和编写时有着足够的轻量级，并能够被用在大量的应用和工具中。</span></span></div></div><div style="font-style: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div><span style="font-size: 14px;"><span style="font-family: Arial, Helvetica, sans-serif;">我们现在所知道的Tornado是基于Bret Taylor和其他人员为FriendFeed所开发的网络服务框架，当FriendFeed被Facebook收购后得以开源。不同于那些最多只能达到10,000个并发连接的传统网络服务器，Tornado在设计之初就考虑到了性能因素，旨在解决C10K问题，这样的设计使得其成为一个拥有非常高性能的框架。此外，它还拥有处理安全性、用户验证、社交网络以及与外部服务（如数据库和网站API）进行异步交互的工具。</span></span></div><div><span style="font-size: 14px;"><span style="font-family: Arial, Helvetica, sans-serif;"><br/></span></span></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>延伸阅读：C10K问题</div><div><br/></div><div>基于线程的服务器，如Apache，为了传入的连接，维护了一个操作系统的线程池。Apache会为每个HTTP连接分配线程池中的一个线程，如果所有的线程都处于被占用的状态并且尚有内存可用时，则生成一个新的线程。尽管不同的操作系统会有不同的设置，大多数Linux发布版中都是默认线程堆大小为8MB。Apache的架构在大负载下变得不可预测，为每个打开的连接维护一个大的线程池等待数据极易迅速耗光服务器的内存资源。</div><div><br/></div><div>大多数社交网络应用都会展示实时更新来提醒新消息、状态变化以及用户通知，这就要求客户端需要保持一个打开的连接来等待服务器端的任何响应。这些长连接或推送请求使得Apache的最大线程池迅速饱和。一旦线程池的资源耗尽，服务器将不能再响应新的请求。</div><div><br/></div><div>异步服务器在这一场景中的应用相对较新，但他们正是被设计用来减轻基于线程的服务器的限制的。当负载增加时，诸如Node.js，lighttpd和Tornodo这样的服务器使用协作的多任务的方式进行优雅的扩展。也就是说，如果当前请求正在等待来自其他资源的数据（比如数据库查询或HTTP请求）时，一个异步服务器可以明确地控制以挂起请求。异步服务器用来恢复暂停的操作的一个常见模式是当合适的数据准备好时调用回调函数。我们将会在第五章讲解回调函数模式以及一系列Tornado异步功能的应用。</div></div><div><span style="font-size: 14px;"><span style="font-family: Arial, Helvetica, sans-serif;"><br/></span></span></div><div><br/></div><div style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div>自从2009年9月10日发布以来，Tornado已经获得了很多社区的支持，并且在一系列不同的场合得到应用。除FriendFeed和Facebook外，还有很多公司在生产上转向Tornado，包括Quora、Turntable.fm、Bit.ly、Hipmunk以及MyYearbook等。</div></div><div><br/></div><div style="font-style: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div><span style="font-size: 14px;"><span style="font-family: Arial, Helvetica, sans-serif;">总之，如果你在寻找你那庞大的CMS或一体化开发框架的替代品，Tornado可能并不是一个好的选择。Tornado并不需要你拥有庞大的模型建立特殊的方式，或以某种确定的形式处理表单，或其他类似的事情。它所做的是让你能够快速简单地编写高速的Web应用。如果你想编写一个可扩展的社交应用、实时分析引擎，或RESTful API，那么简单而强大的Python，以及Tornado（和这本书）正是为你准备的！</span></span></div><div><span style="font-size: 14px;"><span style="font-family: Arial, Helvetica, sans-serif;"><br/></span></span></div><div><br/></div><div style="font-style: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div><span style="font-size: 20px;"><span style="font-family: 'Microsoft Yahei', 'LiHei Pro Medium', sans-serif;"><b>1.1.1 Tornado入门</b></span></span></div><div><b><span style="font-size: 20px;"><span style="font-family: 'Microsoft Yahei', 'LiHei Pro Medium', sans-serif;"><br/></span></span></b></div><div>安装</div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;">pip install tornado</div><div><br/></div><div><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">一旦Tornado在你的机器上安装好，你就可以很好的开始了！压缩包中包含很多demo，比如建立博客、整合Facebook、运行聊天服务等的示例代码。我们稍后会在本书中通过一些示例应用逐步讲解，不过你也应该看看这些官方demo</span></div><div><b><span style="font-size: 20px;"><span style="font-family: 'Microsoft Yahei', 'LiHei Pro Medium', sans-serif;"><br/></span></span></b></div><div><br/></div><div style="font-family: 'Microsoft Yahei', 'LiHei Pro Medium', sans-serif; font-size: 20px; color: rgb(0, 0, 0); font-style: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-weight: bold;"><div>1.1.2 社区和支持</div></div><div><br/></div><div style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div>对于问题、示例和一般的指南，Tornado官方文档是个不错的选择。在<a href="http://tornadoweb.org/" style="text-decoration: none; color: rgb(0, 0, 255);">tornadoweb.org</a>上有大量的例子和功能缺陷，更多细节和变更可以在<a href="http://github.com/facebook/tornado" style="text-decoration: none; color: rgb(0, 0, 255);">Tornado在Github上的版本库</a>中看到。而对于更具体的问题，可以到<a href="http://groups.google.com/group/python-tornado" style="text-decoration: none; color: rgb(0, 0, 255);">Tornado的Google Group</a>中咨询，那里有很多活跃的日常使用Tornado的开发者。</div></div><div><b><span style="font-size: 20px;"><span style="font-family: 'Microsoft Yahei', 'LiHei Pro Medium', sans-serif;"><br/></span></span></b></div><div><br/></div><div style="font-family: 'Microsoft Yahei', 'LiHei Pro Medium', sans-serif; font-size: 23px; color: rgb(0, 0, 0); font-style: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-weight: bold;"><div>1.2 简单的Web服务</div></div><div><br/></div><div style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div>既然我们已经知道了Tornado是什么了，现在让我们看看它能做什么吧。我们首先从使用Tornado编写一个简单的Web应用开始。</div></div><div><b><span style="font-size: 20px;"><span style="font-family: 'Microsoft Yahei', 'LiHei Pro Medium', sans-serif;"><br/></span></span></b></div><div><br/></div><div style="font-style: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div><span style="font-size: 20px;"><span style="font-family: 'Microsoft Yahei', 'LiHei Pro Medium', sans-serif;"><b>1.2.1 Hello Tornado</b></span></span></div><div><span style="font-size: 20px;"><span style="font-family: 'Microsoft Yahei', 'LiHei Pro Medium', sans-serif;"><b><br/></b></span></span></div><div><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">Tornado是一个编写对HTTP请求响应的框架。作为程序员，你的工作是编写响应特定条件HTTP请求的响应的handler。下面是一个全功能的Tornado应用的基础示例：</span></div><div><span style="font-size: 14px;"><span style="font-family: Arial, Helvetica, sans-serif;"><br/></span></span></div><div><span style="font-size: 14px;"><span style="font-family: Arial, Helvetica, sans-serif;"><br/></span></span></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>import tornado.httpserver<br/>
import tornado.ioloop<br/>
import tornado.options<br/>
import tornado.web<br/><br/></div><div>from tornado.options import define, options</div><div><br/></div><div>define(&quot;port&quot;, default=8000, help=&quot;run on the given port&quot;, type=int)<br/><br/>
class IndexHandler(tornado.web.RequestHandler):<br/>
    def get(self):<br/>
        greeting = self.get_argument('greeting', 'Hello')<br/>
        self.write(greeting + ', friendly user!')<br/><br/>
if __name__ == &quot;__main__&quot;:</div><div>    tornado.options.parse_command_line()</div><div><br/></div><div>    app = tornado.web.Application(</div><div>     handlers=[</div><div>          (r&quot;/&quot;, IndexHandler)</div><div>          ]</div><div>     )</div><div>    http_server = tornado.httpserver.HTTPServer(app)<br/>
    http_server.listen(options.port)<br/>
    tornado.ioloop.IOLoop.instance().start()<br/><br/></div></div><div><span style="font-size: 14px;"><span style="font-family: Arial, Helvetica, sans-serif;"><br/></span></span></div></div><div><p style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">编写一个Tornado应用中最多的工作是定义类继承Tornado的<var style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px; font-weight: bold; font-style: normal;">RequestHandler</var>类。在这个例子中，我们创建了一个简单的应用，在给定的端口监听请求，并在根目录（&quot;/&quot;）响应请求。</p></div><div><br/></div><div style="font-style: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div><span style="font-size: 14px;"><span style="font-family: Arial, Helvetica, sans-serif;">你可以在命令行里尝试运行这个程序以测试输出</span></span></div><div><span style="font-size: 14px;"><span style="font-family: Arial, Helvetica, sans-serif;"><br/></span></span></div><div><span style="font-size: 14px;"><span style="font-family: Arial, Helvetica, sans-serif;"><br/></span></span></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>$ python hello.py --port=8000</div></div><div><span style="font-size: 14px;"><span style="font-family: Arial, Helvetica, sans-serif;"><br/></span></span></div><div><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">现在你可以在浏览器中打开</span><a href="http://localhost:8000/" style="text-decoration: none; color: rgb(0, 0, 255); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">http://localhost:8000</a><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">，或者打开另一个终端窗口使用curl测试我们的应用：</span></div><div><span style="font-size: 14px;"><span style="font-family: Arial, Helvetica, sans-serif;"><br/></span></span></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>curl  http://192.168.201.130:8000/</div><div>Hello, friendly user!</div><div>curl  http://192.168.201.130:8000/?greeting=Salutations</div><div>Salutations, friendly user!<br/><br/></div></div><div><span style="font-size: 14px;"><span style="font-family: Arial, Helvetica, sans-serif;"><br/></span></span></div><div><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">让我们把这个例子分成小块，逐步分析它们：</span></div><div><span style="font-size: 14px;"><span style="font-family: Arial, Helvetica, sans-serif;"><br/></span></span></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>import tornado.httpserver<br/>
import tornado.ioloop<br/>
import tornado.options</div><div>import tornado.web</div></div><div><span style="font-size: 14px;"><span style="font-family: Arial, Helvetica, sans-serif;"><br/></span></span></div><div><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">1、在程序的最顶部，我们导入了一些Tornado模块。虽然Tornado还有另外一些有用的模块，但在这个例子中我们必须至少包含这四个模块。</span></div><div><span style="font-size: 14px;"><span style="font-family: Arial, Helvetica, sans-serif;"><br/></span></span></div><div><span style="font-size: 14px;"><span style="font-family: Arial, Helvetica, sans-serif;"><br/></span></span></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>from tornado.options import define, options</div><div>define(&quot;port&quot;, default=8000, help=&quot;run on the given port&quot;, type=int)</div></div><div><span style="font-size: 14px;"><span style="font-family: Arial, Helvetica, sans-serif;"><br/></span></span></div><div><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">2、Tornado包括了一个有用的模块（</span><var style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px; font-weight: bold; font-style: normal; color: rgb(0, 0, 0); font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">tornado.options</var><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">）来从命令行中读取设置。我们在这里使用这个模块指定我们的应用监听HTTP请求的端口。它的工作流程如下：如果一个与</span><var style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px; font-weight: bold; font-style: normal; color: rgb(0, 0, 0); font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">define</var><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">语句中同名的设置在命令行中被给出，那么它将成为全局</span><var style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px; font-weight: bold; font-style: normal; color: rgb(0, 0, 0); font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">options</var><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">的一个属性。如果用户运行程序时使用了</span><code style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px; color: rgb(0, 0, 0); font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">--help</code><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">选项，程序将打印出所有你定义的选项以及你在</span><var style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px; font-weight: bold; font-style: normal; color: rgb(0, 0, 0); font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">define</var><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">函数的</span><var style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px; font-weight: bold; font-style: normal; color: rgb(0, 0, 0); font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">help</var><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">参数中指定的文本。如果用户没有为这个选项指定值，则使用</span><var style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px; font-weight: bold; font-style: normal; color: rgb(0, 0, 0); font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">default</var><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">的值进行代替。Tornado使用</span><var style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px; font-weight: bold; font-style: normal; color: rgb(0, 0, 0); font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">type</var><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">参数进行基本的参数类型验证，当不合适的类型被给出时抛出一个异常。因此，我们允许一个整数的</span><var style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px; font-weight: bold; font-style: normal; color: rgb(0, 0, 0); font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">port</var><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">参数作为</span><var style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px; font-weight: bold; font-style: normal; color: rgb(0, 0, 0); font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">options.port</var><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">来访问程序。如果用户没有指定值，则默认为8000。</span></div><div><span style="font-size: 14px;"><span style="font-family: Arial, Helvetica, sans-serif;"><br/></span></span></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>$ python 1_lesson_helloworld.py -- help</div></div><div><span style="font-size: 14px;"><span style="font-family: Arial, Helvetica, sans-serif;"><br/></span></span></div><div><span style="font-size: 14px;"><span style="font-family: Arial, Helvetica, sans-serif;"><br/></span></span></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>class IndexHandler(tornado.web.RequestHandler):<br/>
    def get(self):<br/>
        greeting = self.get_argument('greeting', 'Hello')</div><div>        self.write(greeting + ', friendly user!')</div></div><div><span style="font-size: 14px;"><span style="font-family: Arial, Helvetica, sans-serif;"><br/></span></span></div><div><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">3、这是Tornado的请求处理函数类。当处理一个请求时，Tornado将这个类实例化，并调用与HTTP请求方法所对应的方法。在这个例子中，我们只定义了一个</span><var style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px; font-weight: bold; font-style: normal; color: rgb(0, 0, 0); font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">get</var><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">方法，也就是说这个处理函数将对HTTP的</span><dfn style="font-family: Roboto, monospace; font-style: normal; letter-spacing: -1px; color: rgb(0, 0, 0); font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">GET</dfn><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">请求作出响应。我们稍后将看到实现不止一个HTTP方法的处理函数。</span></div><div><span style="font-size: 14px;"><span style="font-family: Arial, Helvetica, sans-serif;"><br/></span></span></div><div><span style="font-size: 14px;"><span style="font-family: Arial, Helvetica, sans-serif;"><br/></span></span></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>greeting = self.get_argument('greeting', 'Hello')</div></div><div><span style="font-size: 14px;"><span style="font-family: Arial, Helvetica, sans-serif;"><br/></span></span></div></div></div><div><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">4、Tornado的</span><var style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px; font-weight: bold; font-style: normal; color: rgb(0, 0, 0); font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">RequestHandler</var><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">类有一系列有用的内建方法，包括</span><var style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px; font-weight: bold; font-style: normal; color: rgb(0, 0, 0); font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">get_argument</var><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">，我们在这里从一个查询字符串中取得参数</span><var style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px; font-weight: bold; font-style: normal; color: rgb(0, 0, 0); font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">greeting</var><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">的值。（如果这个参数没有出现在查询字符串中，Tornado将使用</span><var style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px; font-weight: bold; font-style: normal; color: rgb(0, 0, 0); font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">get_argument</var><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">的第二个参数作为默认值。）</span></div><div><span style="font-size: 14px;"><span style="font-family: Arial, Helvetica, sans-serif;"><br/></span></span></div><div><br/></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>查询字符串query string，在地址栏中 “?” 号后面的字符串， key01=value01&amp;key02=value02</div></div><div><span style="font-size: 14px;"><span style="font-family: Arial, Helvetica, sans-serif;"><br/></span></span></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>self.write(greeting + ', friendly user!')</div></div><div><span style="font-size: 14px;"><span style="font-family: Arial, Helvetica, sans-serif;"><br/></span></span></div><div><var style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px; font-weight: bold; font-style: normal; color: rgb(0, 0, 0); font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">5、RequestHandler</var><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">的另一个有用的方法是</span><var style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px; font-weight: bold; font-style: normal; color: rgb(0, 0, 0); font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">write</var><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">，它以一个字符串作为函数的参数，并将其写入到HTTP响应中。在这里，我们使用请求中</span><var style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px; font-weight: bold; font-style: normal; color: rgb(0, 0, 0); font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">greeting</var><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">参数提供的值插入到greeting中，并写回到响应中。</span></div><div><span style="font-size: 14px;"><span style="font-family: Arial, Helvetica, sans-serif;"><br/></span></span></div><div><span style="font-size: 14px;"><span style="font-family: Arial, Helvetica, sans-serif;"><br/></span></span></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>if __name__ == &quot;__main__&quot;:<br/>
    tornado.options.parse_command_line()</div><div>    app = tornado.web.Application(handlers=[(r&quot;/&quot;, IndexHandler)])</div></div><div><span style="font-size: 14px;"><span style="font-family: Arial, Helvetica, sans-serif;"><br/></span></span></div><div><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">6、这是真正使得Tornado运转起来的语句。首先，我们使用Tornado的</span><var style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px; font-weight: bold; font-style: normal; color: rgb(0, 0, 0); font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">options</var><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">模块来解析命令行。然后我们创建了一个Tornado的</span><var style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px; font-weight: bold; font-style: normal; color: rgb(0, 0, 0); font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">Application</var><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">类的实例。传递给</span><var style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px; font-weight: bold; font-style: normal; color: rgb(0, 0, 0); font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">Application</var><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">类</span><var style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px; font-weight: bold; font-style: normal; color: rgb(0, 0, 0); font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">__init__</var><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">方法的最重要的参数是</span><var style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px; font-weight: bold; font-style: normal; color: rgb(0, 0, 0); font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">handlers</var><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">。它告诉Tornado应该用哪个类来响应请求。马上我们讲解更多相关知识。</span></div><div><span style="font-size: 14px;"><span style="font-family: Arial, Helvetica, sans-serif;"><br/></span></span></div><div><span style="font-size: 14px;"><span style="font-family: Arial, Helvetica, sans-serif;"><br/></span></span></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>http_server = tornado.httpserver.HTTPServer(app)<br/>
http_server.listen(options.port)</div><div>tornado.ioloop.IOLoop.instance().start()</div></div><div><span style="font-size: 14px;"><span style="font-family: Arial, Helvetica, sans-serif;"><br/></span></span></div><div><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">7、从这里开始的代码将会被反复使用：一旦</span><var style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px; font-weight: bold; font-style: normal; color: rgb(0, 0, 0); font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">Application</var><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">对象被创建，我们可以将其传递给Tornado的</span><var style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px; font-weight: bold; font-style: normal; color: rgb(0, 0, 0); font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">HTTPServer</var><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">对象，然后使用我们在命令行指定的端口进行监听（通过</span><var style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px; font-weight: bold; font-style: normal; color: rgb(0, 0, 0); font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">options</var><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">对象取出。）最后，在程序准备好接收HTTP请求后，我们创建一个Tornado的</span><var style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px; font-weight: bold; font-style: normal; color: rgb(0, 0, 0); font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">IOLoop</var><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">的实例。</span></div><div><span style="font-size: 14px;"><span style="font-family: Arial, Helvetica, sans-serif;"><br/></span></span></div></div><div><br/></div><div style="font-family: 'Microsoft Yahei', 'LiHei Pro Medium', sans-serif; font-size: 17px; color: rgb(0, 0, 0); font-style: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-weight: bold;"><div>1.2.1.1 参数handlers</div></div><div><span style="font-size: 14px;"><span style="font-family: Arial, Helvetica, sans-serif;"><br/></span></span></div></div><div><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">让我们再看一眼</span><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">hello.py</span><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">示例中的这一行：</span></div><div><span style="font-size: 14px;"><span style="font-family: Arial, Helvetica, sans-serif;"><br/></span></span></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>app = tornado.web.Application(handlers=[(r&quot;/&quot;, IndexHandler)])</div></div><div><span style="font-size: 14px;"><span style="font-family: Arial, Helvetica, sans-serif;"><br/></span></span></div><div><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">这里的参数</span><var style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px; font-weight: bold; font-style: normal; color: rgb(0, 0, 0); font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">handlers</var><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">非常重要，值得我们更加深入的研究。它应该是一个元组组成的列表，其中每个元组的第一个元素是一个用于匹配的正则表达式，第二个元素是一个</span><var style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px; font-weight: bold; font-style: normal; color: rgb(0, 0, 0); font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">RequestHanlder</var><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">类。在</span><var style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px; font-weight: bold; font-style: normal; color: rgb(0, 0, 0); font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">hello.py</var><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">中，我们只指定了一个正则表达式-</span><var style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px; font-weight: bold; font-style: normal; color: rgb(0, 0, 0); font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">RequestHanlder</var><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">对，但你可以按你的需要指定任意多个。</span></div><div><span style="font-size: 14px;"><span style="font-family: Arial, Helvetica, sans-serif;"><br/></span></span></div><div><span style="font-size: 14px;"><span style="font-family: Arial, Helvetica, sans-serif;"><br/></span></span></div><div><br/></div><div><br/></div><div style="font-style: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div><span style="font-size: 17px;"><span style="font-family: 'Microsoft Yahei', 'LiHei Pro Medium', sans-serif;"><b>1.2.1.2 使用正则表达式指定路径<a href="http://demo.pythoner.com/itt2zh/ch1.html#ch1-2-1-2" style="text-decoration: none; color: rgb(255, 255, 255); margin-left: 5px;">¶</a></b></span></span></div><div><span style="font-size: 17px;"><span style="font-family: 'Microsoft Yahei', 'LiHei Pro Medium', sans-serif;"><b><br/></b></span></span></div><div><p style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">Tornado在元组中使用正则表达式来匹配HTTP请求的路径。（这个路径是URL中主机名后面的部分，不包括查询字符串和碎片。）Tornado把这些正则表达式看作已经包含了行开始和结束锚点（即，字符串&quot;/&quot;被看作为&quot;^/$&quot;）。</p></div><div><br/></div><div style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div>如果一个正则表达式包含一个捕获分组（即，正则表达式中的部分被括号括起来），匹配的内容将作为相应HTTP请求的参数传到<var style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px; font-weight: bold; font-style: normal;">RequestHandler</var>对象中。我们将在下个例子中看到它的用法。</div></div></div><div><span style="font-size: 16px;"><span style="font-family: Lato, proxima-nova, 'Helvetica Neue', Arial, sans-serif;"><span style="background-color: rgb(252, 252, 252);"><span style="color: rgb(64, 64, 64);"><br/></span></span></span></span></div><div><h3 style="font-family: &quot;Microsoft Yahei&quot;, &quot;LiHei Pro Medium&quot;, sans-serif; font-size: 20px; color: rgb(0, 0, 0); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">1.2.2 字符串服务<a href="http://demo.pythoner.com/itt2zh/ch1.html#ch1-2-2" style="text-decoration: none; color: rgb(255, 255, 255); margin-left: 5px;">¶</a></h3></div><div><br/></div><div style="font-style: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div><span style="font-size: 14px;"><span style="font-family: Arial, Helvetica, sans-serif;">例1-2是一个我们目前为止看到的更复杂的例子，它将介绍更多Tornado的基本概念。</span></span></div><div><span style="font-size: 14px;"><span style="font-family: Arial, Helvetica, sans-serif;"><br/></span></span></div><div><span style="font-size: 14px;"><span style="font-family: Arial, Helvetica, sans-serif;"><br/></span></span></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>import textwrap<br/><br/>
import tornado.httpserver<br/>
import tornado.ioloop<br/>
import tornado.options<br/>
import tornado.web<br/><br/>
from tornado.options import define, options<br/>
define(&quot;port&quot;, default=8000, help=&quot;run on the given port&quot;, type=int)<br/><br/>
class ReverseHandler(tornado.web.RequestHandler):<br/>
    def get(self, input):<br/>
        self.write(input[::-1])<br/><br/>
class WrapHandler(tornado.web.RequestHandler):<br/>
    def post(self):<br/>
        text = self.get_argument('text')<br/>
        width = self.get_argument('width', 40)<br/>
        self.write(textwrap.fill(text, int(width)))<br/>
       <br/>
if __name__ == &quot;__main__&quot;:<br/>
    tornado.options.parse_command_line()<br/>
    app = tornado.web.Application(<br/>
        handlers=[<br/>
            (r&quot;/reverse/(\w+)&quot;, ReverseHandler),<br/>
            (r&quot;/wrap&quot;, WrapHandler)<br/>
        ]<br/>
    )<br/>
    http_server = tornado.httpserver.HTTPServer(app)<br/>
    http_server.listen(options.port)<br/>
    tornado.ioloop.IOLoop.instance().start()<br/><br/></div></div><div><span style="font-size: 14px;"><span style="font-family: Arial, Helvetica, sans-serif;"><br/></span></span></div><div><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">如同运行第一个例子，你可以在命令行中运行这个例子使用如下的命令：</span></div><div><span style="font-size: 14px;"><span style="font-family: Arial, Helvetica, sans-serif;"><br/></span></span></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>$ python string_service.py --port=8000</div></div><div><span style="font-size: 14px;"><span style="font-family: Arial, Helvetica, sans-serif;"><br/></span></span></div><div><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">这个程序是一个通用的字符串操作的Web服务端基本框架。到目前为止，你可以用它做两件事情。其一，到</span><code style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px; color: rgb(0, 0, 0); font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">/reverse/string</code><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">的</span><dfn style="font-family: Roboto, monospace; font-style: normal; letter-spacing: -1px; color: rgb(0, 0, 0); font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">GET</dfn><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">请求将会返回URL路径中指定字符串的反转形式。</span></div><div><span style="font-size: 16px;"><span style="font-family: Lato, proxima-nova, 'Helvetica Neue', Arial, sans-serif;"><span style="background-color: rgb(252, 252, 252);"><span style="color: rgb(64, 64, 64);"><br/></span></span></span></span></div></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>$ curl  http://192.168.201.130:8000/reverse/stressed</div><div>desserts</div><div><br/></div><div>$ curl  http://192.168.201.130:8000/reverse/slipup</div><div>pupils<br/><br/></div></div><div><span style="font-size: 16px;"><span style="font-family: Lato, proxima-nova, 'Helvetica Neue', Arial, sans-serif;"><span style="background-color: rgb(252, 252, 252);"><span style="color: rgb(64, 64, 64);"><br/></span></span></span></span></div><div><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">其二，到</span><code style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px; color: rgb(0, 0, 0); font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">/wrap</code><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">的</span><dfn style="font-family: Roboto, monospace; font-style: normal; letter-spacing: -1px; color: rgb(0, 0, 0); font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">POST</dfn><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">请求将从参数</span><var style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px; font-weight: bold; font-style: normal; color: rgb(0, 0, 0); font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">text</var><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">中取得指定的文本，并返回按照参数</span><var style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px; font-weight: bold; font-style: normal; color: rgb(0, 0, 0); font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">width</var><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">指定宽度装饰的文本。下面的请求指定一个没有宽度的字符串，所以它的输出宽度被指定为程序中的</span><var style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px; font-weight: bold; font-style: normal; color: rgb(0, 0, 0); font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">get_argument</var><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">的默认值40个字符。</span></div><div><span style="font-size: 14px;"><span style="font-family: Arial, Helvetica, sans-serif;"><br/></span></span></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>$ curl  http://192.168.201.130:8000/ -d text=sfefgsgsergsdrhsdrtsdfhgsdrhsdrt</div><div><br/></div><div>$ curl  http://192.168.201.130:8000/ -d foo=bar</div><div><br/></div></div><div><span style="font-size: 14px;"><span style="font-family: Arial, Helvetica, sans-serif;"><br/></span></span></div><div><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">字符串服务示例和上一节示例代码中大部分是一样的。让我们关注那些新的代码。首先，让我们看看传递给</span><var style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px; font-weight: bold; font-style: normal; color: rgb(0, 0, 0); font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">Application</var><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">构造函数的</span><var style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px; font-weight: bold; font-style: normal; color: rgb(0, 0, 0); font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">handlers</var><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">参数的值：</span></div><div><span style="font-size: 14px;"><span style="font-family: Arial, Helvetica, sans-serif;"><br/></span></span></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>app = tornado.web.Application(handlers=[<br/>
    (r&quot;/reverse/(\w+)&quot;, ReverseHandler),<br/>
    (r&quot;/wrap&quot;, WrapHandler)<br/>
])</div><div><br/></div></div><div><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">1、在上面的代码中，</span><var style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px; font-weight: bold; font-style: normal; color: rgb(0, 0, 0); font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">Application</var><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">类在&quot;handlers&quot;参数中实例化了两个</span><var style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px; font-weight: bold; font-style: normal; color: rgb(0, 0, 0); font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">RequestHandler</var><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">类对象。第一个引导Tornado传递路径匹配下面的正则表达式的请求：</span></div><div><span style="font-size: 16px;"><span style="font-family: Lato, proxima-nova, 'Helvetica Neue', Arial, sans-serif;"><span style="background-color: rgb(252, 252, 252);"><span style="color: rgb(64, 64, 64);"><br/></span></span></span></span></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>/reverse/(\w+)<br/><br/></div></div><div><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">正则表达式告诉Tornado匹配任何以字符串/reverse/开始并紧跟着一个或多个字母的路径。括号的含义是让Tornado保存匹配括号里面表达式的字符串，并将其作为请求方法的一个参数传递给</span><var style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px; font-weight: bold; font-style: normal; color: rgb(0, 0, 0); font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">RequestHandler</var><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">类。让我们检查</span><var style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px; font-weight: bold; font-style: normal; color: rgb(0, 0, 0); font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">ReverseHandler</var><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">的定义来看看它是如何工作的：</span></div><div><span style="font-size: 14px;"><span style="font-family: Arial, Helvetica, sans-serif;"><br/></span></span></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>class ReverseHandler(tornado.web.RequestHandler):<br/>
    def get(self, input):<br/>
        self.write(input[::-1])<br/><br/></div></div><div><span style="font-size: 14px;"><span style="font-family: Arial, Helvetica, sans-serif;"><br/></span></span></div><div><p style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">你可以看到这里的<var style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px; font-weight: bold; font-style: normal;">get</var>方法有一个额外的参数<var style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px; font-weight: bold; font-style: normal;">input</var>。这个参数将包含匹配处理函数正则表达式第一个括号里的字符串。（如果正则表达式中有一系列额外的括号，匹配的字符串将被按照在正则表达式中出现的顺序作为额外的参数传递进来。）</p></div><div><br/></div><div style="font-style: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div><span style="font-size: 14px;"><span style="font-family: Arial, Helvetica, sans-serif;">2、现在，让我们看一下</span><var style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px; font-weight: bold; font-style: normal;">WrapHandler</var><span style="font-family: Arial, Helvetica, sans-serif;">的定义：</span></span></div><div><span style="font-size: 14px;"><span style="font-family: Arial, Helvetica, sans-serif;"><br/></span></span></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>class WrapHandler(tornado.web.RequestHandler):<br/>
    def post(self):<br/>
        text = self.get_argument('text')<br/>
        width = self.get_argument('width', 40)<br/>
        self.write(textwrap.fill(text, int(width)))<br/><br/></div></div><div><span style="font-size: 14px;"><span style="font-family: Arial, Helvetica, sans-serif;"><br/></span></span></div><div><br/></div><div style="font-style: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div><span style="font-size: 14px;"><var style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px; font-weight: bold; font-style: normal;">WrapHandler</var><span style="font-family: Arial, Helvetica, sans-serif;">类处理匹配路径为</span><code style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px;">/wrap</code><span style="font-family: Arial, Helvetica, sans-serif;">的请求。这个处理函数定义了一个</span><var style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px; font-weight: bold; font-style: normal;">post</var><span style="font-family: Arial, Helvetica, sans-serif;">方法，也就是说它接收HTTP的</span><dfn style="font-family: Roboto, monospace; font-style: normal; letter-spacing: -1px;">POST</dfn><span style="font-family: Arial, Helvetica, sans-serif;">方法的请求。</span></span></div></div><div style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div>我们之前使用<var style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px; font-weight: bold; font-style: normal;">RequestHandler</var>对象的<var style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px; font-weight: bold; font-style: normal;">get_argument</var>方法来捕获请求查询字符串的的参数。同样，我们也可以使用相同的方法来获得<dfn style="font-family: Roboto, monospace; font-style: normal; letter-spacing: -1px;">POST</dfn>请求传递的参数。（Tornado可以解析URLencoded和multipart结构的<dfn style="font-family: Roboto, monospace; font-style: normal; letter-spacing: -1px;">POST</dfn>请求）。一旦我们从<dfn style="font-family: Roboto, monospace; font-style: normal; letter-spacing: -1px;">POST</dfn>中获得了文本和宽度的参数，我们使用Python内建的<var style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px; font-weight: bold; font-style: normal;">textwrap</var>模块来以指定的宽度装饰文本，并将结果字符串写回到HTTP响应中。</div></div><div><span style="font-size: 14px;"><span style="font-family: Arial, Helvetica, sans-serif;"><br/></span></span></div><div><br/></div><div style="font-style: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div><span style="font-size: 20px;"><span style="font-family: 'Microsoft Yahei', 'LiHei Pro Medium', sans-serif;"><b>1.2.3 关于RequestHandler的更多知识</b></span></span></div><div><span style="font-size: 20px;"><span style="font-family: 'Microsoft Yahei', 'LiHei Pro Medium', sans-serif;"><b><br/></b></span></span></div><div><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">到目前为止，我们已经了解了</span><var style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px; font-weight: bold; font-style: normal; color: rgb(0, 0, 0); font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">RequestHandler</var><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">对象的基础：如何从一个传入的HTTP请求中获得信息（使用</span><var style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px; font-weight: bold; font-style: normal; color: rgb(0, 0, 0); font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">get_argument</var><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">和传入到</span><var style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px; font-weight: bold; font-style: normal; color: rgb(0, 0, 0); font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">get</var><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">和</span><var style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px; font-weight: bold; font-style: normal; color: rgb(0, 0, 0); font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">post</var><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">的参数）以及写HTTP响应（使用</span><var style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px; font-weight: bold; font-style: normal; color: rgb(0, 0, 0); font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">write</var><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">方法）。除此之外，还有很多需要学习的，我们将在接下来的章节中进行讲解。同时，还有一些关于</span><var style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px; font-weight: bold; font-style: normal; color: rgb(0, 0, 0); font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">RequestHandler</var><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">和Tornado如何使用它的只是需要记住。</span></div></div><div><span style="font-size: 14px;"><span style="font-family: Arial, Helvetica, sans-serif;"><br/></span></span></div></div><div><br/></div><div style="font-style: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div><span style="font-size: 17px;"><span style="font-family: 'Microsoft Yahei', 'LiHei Pro Medium', sans-serif;"><b>1.2.3.1 HTTP方法</b></span></span></div><div><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">截止到目前讨论的例子，每个</span><var style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px; font-weight: bold; font-style: normal; color: rgb(0, 0, 0); font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">RequestHandler</var><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">类都只定义了一个HTTP方法的行为。但是，在同一个处理函数中定义多个方法是可能的，并且是有用的。把概念相关的功能绑定到同一个类是一个很好的方法。比如，你可能会编写一个处理函数来处理数据库中某个特定ID的对象，既使用</span><dfn style="font-family: Roboto, monospace; font-style: normal; letter-spacing: -1px; color: rgb(0, 0, 0); font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">GET</dfn><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">方法，也使用</span><dfn style="font-family: Roboto, monospace; font-style: normal; letter-spacing: -1px; color: rgb(0, 0, 0); font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">POST</dfn><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">方法。想象</span><dfn style="font-family: Roboto, monospace; font-style: normal; letter-spacing: -1px; color: rgb(0, 0, 0); font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">GET</dfn><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">方法来返回这个部件的信息，而</span><dfn style="font-family: Roboto, monospace; font-style: normal; letter-spacing: -1px; color: rgb(0, 0, 0); font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">POST</dfn><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">方法在数据库中对这个ID的部件进行改变：</span></div><div><span style="font-size: 14px;"><span style="font-family: Arial, Helvetica, sans-serif;"><br/></span></span></div><div><span style="font-size: 14px;"><span style="font-family: Arial, Helvetica, sans-serif;"><br/></span></span></div><div><span style="font-size: 14px;"><span style="font-family: Arial, Helvetica, sans-serif;"><br/></span></span></div><div><span style="font-size: 14px;"><span style="font-family: Arial, Helvetica, sans-serif;"><br/></span></span></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div># matched with (r&quot;/widget/(\d+)&quot;, WidgetHandler)</div><div><br/></div><div><br/></div><div><br/></div><div>widget = {'1': 'aaaa', '2': 'bbbb', '3': 'cccc'}</div><div><br/></div><div>def retrieve_from_db(widget_id):</div><div>    return True if widget.get(widget_id) else {}</div><div><br/></div><div>def save_to_db(wid):</div><div>    widget.update(wid)<br/><br/></div><div><br/></div><div><br/></div><div>class WidgetHandler(tornado.web.RequestHandler):</div><div>    def get(self, widget_id):</div><div>        wid = retrieve_from_db(widget_id)</div><div>        self.write(widget[widget_id] if wid else 'no')</div><div><br/></div><div>    def post(self, widget_id):</div><div>        wid = retrieve_from_db(widget_id)</div><div>        if not wid:</div><div>            wid[widget_id] = self.get_argument('foo')</div><div>            save_to_db(wid)</div><div>        self.write(widget)</div></div><div><span style="font-size: 14px;"><span style="font-family: Arial, Helvetica, sans-serif;"><br/></span></span></div><div><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">我们到目前为止只是用了</span><dfn style="font-family: Roboto, monospace; font-style: normal; letter-spacing: -1px; color: rgb(0, 0, 0); font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">GET</dfn><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">和</span><dfn style="font-family: Roboto, monospace; font-style: normal; letter-spacing: -1px; color: rgb(0, 0, 0); font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">POST</dfn><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">方法，但Tornado支持任何合法的HTTP请求（</span><dfn style="font-family: Roboto, monospace; font-style: normal; letter-spacing: -1px; color: rgb(0, 0, 0); font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">GET</dfn><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">、</span><dfn style="font-family: Roboto, monospace; font-style: normal; letter-spacing: -1px; color: rgb(0, 0, 0); font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">POST</dfn><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">、</span><dfn style="font-family: Roboto, monospace; font-style: normal; letter-spacing: -1px; color: rgb(0, 0, 0); font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">PUT</dfn><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">、</span><dfn style="font-family: Roboto, monospace; font-style: normal; letter-spacing: -1px; color: rgb(0, 0, 0); font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">DELETE</dfn><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">、</span><dfn style="font-family: Roboto, monospace; font-style: normal; letter-spacing: -1px; color: rgb(0, 0, 0); font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">HEAD</dfn><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">、</span><dfn style="font-family: Roboto, monospace; font-style: normal; letter-spacing: -1px; color: rgb(0, 0, 0); font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">OPTIONS</dfn><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">）。你可以非常容易地定义上述任一种方法的行为，只需要在</span><var style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px; font-weight: bold; font-style: normal; color: rgb(0, 0, 0); font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">RequestHandler</var><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">类中使用同名的方法。下面是另一个想象的例子，在这个例子中针对特定frob ID的</span><dfn style="font-family: Roboto, monospace; font-style: normal; letter-spacing: -1px; color: rgb(0, 0, 0); font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">HEAD</dfn><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">请求只根据frob是否存在给出信息，而</span><dfn style="font-family: Roboto, monospace; font-style: normal; letter-spacing: -1px; color: rgb(0, 0, 0); font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">GET</dfn><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">方法返回整个对象：</span></div><div><span style="font-size: 14px;"><span style="font-family: Arial, Helvetica, sans-serif;"><br/></span></span></div><div style="box-sizing: border-box; padding: 8px; font-size: 12px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);"><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);"># matched with (r&quot;/frob/(\d+)&quot;, FrobHandler)</span></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);"><br/></span></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">class FrobHandler(tornado.web.RequestHandler):</span></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">    def head(self, frob_id):</span></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">        frob = retrieve_from_db(frob_id)</span></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">        if frob:</span></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">            self.set_status(200)</span></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">        else:</span></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">            self.set_status(404)</span></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);"><br/></span></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">    def get(self, frob_id):</span></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">        frob = retrieve_from_db(frob_id)</span></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">        if frob:</span></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">            self.write(widget[frob_id])</span></span></div></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);"><br/></span></span></span></div><div><br/></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>curl -i -X HEAD http://192.168.201.130:8000/frob/1</div><div><br/></div><div>curl  http://192.168.201.130:8000/frob/2</div></div><div><br/></div><div><br/></div><div style="font-style: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div><span style="font-size: 17px;"><span style="font-family: 'Microsoft Yahei', 'LiHei Pro Medium', sans-serif;"><b>1.2.3.2 HTTP状态码</b></span></span></div><div><span style="font-size: 17px;"><span style="font-family: 'Microsoft Yahei', 'LiHei Pro Medium', sans-serif;"><b><br/></b></span></span></div><div><br/></div><div><div style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div>从上面的代码可以看出，你可以使用<var style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px; font-weight: bold; font-style: normal;">RequestHandler</var>类的<var style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px; font-weight: bold; font-style: normal;">set_status()</var>方法显式地设置HTTP状态码。然而，你需要记住在某些情况下，Tornado会自动地设置HTTP状态码。下面是一个常用情况的：</div><div><br/></div></div><h5 style="font-style: italic; font-size: 15px; margin: 0px; color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">404 Not Found</h5><p style="margin-left: 25px; color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">Tornado会在HTTP请求的路径无法匹配任何<var style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px; font-weight: bold; font-style: normal;">RequestHandler</var>类相对应的模式时返回404（Not Found）响应码。</p><h5 style="font-style: italic; font-size: 15px; margin: 0px; color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">400 Bad Request</h5><p style="margin-left: 25px; color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">如果你调用了一个没有默认值的<var style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px; font-weight: bold; font-style: normal;">get_argument</var>函数，并且没有发现给定名称的参数，Tornado将自动返回一个400（Bad Request）响应码。</p><h5 style="font-style: italic; font-size: 15px; margin: 0px; color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">405 Method Not Allowed</h5><p style="margin-left: 25px; color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">如果传入的请求使用了<var style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px; font-weight: bold; font-style: normal;">RequestHandler</var>中没有定义的HTTP方法（比如，一个<dfn style="font-family: Roboto, monospace; font-style: normal; letter-spacing: -1px;">POST</dfn>请求，但是处理函数中只有定义了<var style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px; font-weight: bold; font-style: normal;">get</var>方法），Tornado将返回一个405（Methos Not Allowed）响应码。</p><h5 style="font-style: italic; font-size: 15px; margin: 0px; color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">500 Internal Server Error</h5><p style="margin-left: 25px; color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">当程序遇到任何不能让其退出的错误时，Tornado将返回500（Internal Server Error）响应码。你代码中任何没有捕获的异常也会导致500响应码。</p><h5 style="font-style: italic; font-size: 15px; margin: 0px; color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">200 OK</h5><p style="margin-left: 25px; color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">如果响应成功，并且没有其他返回码被设置，Tornado将默认返回一个200（OK）响应码。</p></div><div><br/></div><div style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div>当上述任何一种错误发生时，Tornado将默认向客户端发送一个包含状态码和错误信息的简短片段。如果你想使用自己的方法代替默认的错误响应，你可以重写<var style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px; font-weight: bold; font-style: normal;">write_error</var>方法在你的<var style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px; font-weight: bold; font-style: normal;">RequestHandler</var>类中。比如，代码清单1-3是<span style="font-style: italic; margin: 0px 2px;">hello.py</span>示例添加了常规的错误消息的版本。</div><div><br/></div><div><br/></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>#coding=utf-8</div><div>import tornado.httpserver</div><div>import tornado.ioloop</div><div>import tornado.options</div><div>import tornado.web</div><div><br/></div><div>from tornado.options import define, options</div><div>define(&quot;port&quot;, default=8000, help=&quot;run on the given port&quot;, type=int)</div><div><br/></div><div>class IndexHandler(tornado.web.RequestHandler):</div><div>    def get(self):</div><div>        greeting = self.get_argument('greeting', 'Hello')</div><div>        self.write(greeting + ', friendly user!')</div><div><br/></div><div>    def write_error(self, status_code, **kwargs):</div><div>        self.write(&quot;%d \n&quot; % status_code)</div><div><br/></div><div>if __name__ == &quot;__main__&quot;:</div><div>    tornado.options.parse_command_line()</div><div>    app = tornado.web.Application(handlers=[(r&quot;/&quot;, IndexHandler)])</div><div>    http_server = tornado.httpserver.HTTPServer(app)</div><div>    http_server.listen(options.port)</div><div>    tornado.ioloop.IOLoop.instance().start()<br/><br/></div></div><div><br/></div></div><div><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">当我们尝试一个</span><dfn style="font-family: Roboto, monospace; font-style: normal; letter-spacing: -1px; color: rgb(0, 0, 0); font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">POST</dfn><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">请求时，会得到下面的响应。一般来说，我们应该得到Tornado默认的错误响应，但因为我们覆写了</span><var style="font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; margin: 0px 2px; font-weight: bold; font-style: normal; color: rgb(0, 0, 0); font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">write_error</var><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">，我们会得到不一样的东西：</span></div><div><span style="font-size: 14px;"><span style="font-family: Arial, Helvetica, sans-serif;"><br/></span></span></div><div><span style="font-size: 14px;"><span style="font-family: Arial, Helvetica, sans-serif;"><br/></span></span></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>$ curl  http://192.168.201.130:8000/ -d foo=bar</div><div>405</div><div><br/></div></div><div><span style="font-size: 14px;"><span style="font-family: Arial, Helvetica, sans-serif;"><br/></span></span></div></div><div><br/></div><div style="font-style: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div><span style="font-size: 20px;"><span style="font-family: 'Microsoft Yahei', 'LiHei Pro Medium', sans-serif;"><b>1.2.4 下一步</b></span></span></div><div><b><span style="font-size: 20px;"><span style="font-family: 'Microsoft Yahei', 'LiHei Pro Medium', sans-serif;"><br/></span></span></b></div><div><span style="color: rgb(0, 0, 0); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">现在你已经明白了最基本的东西，我们渴望你想了解更多。在接下来的章节，我们将向你展示能够帮助你使用Tornado创建成熟的Web服务和应用的功能和技术。首先是：Tornado的模板系统。</span></div><div><span style="font-size: 20px;"><span style="font-family: 'Microsoft Yahei', 'LiHei Pro Medium', sans-serif;"><b><br/></b></span></span></div></div></div><div><span style="font-size: 16px;"><span style="font-family: Lato, proxima-nova, 'Helvetica Neue', Arial, sans-serif;"><span style="background-color: rgb(252, 252, 252);"><span style="color: rgb(64, 64, 64);"><br/></span></span></span></span></div><div><span style="font-size: 16px;"><span style="font-family: Lato, proxima-nova, 'Helvetica Neue', Arial, sans-serif;"><span style="background-color: rgb(252, 252, 252);"><span style="color: rgb(64, 64, 64);"><br/></span></span></span></span></div></span>
</div></body></html> 